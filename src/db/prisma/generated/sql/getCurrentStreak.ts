
/* !!! This is code generated by Prisma. Do not edit directly. !!! */
/* eslint-disable */
// biome-ignore-all lint: generated file
// @ts-nocheck 
import * as $runtime from "@prisma/client/runtime/client"

/**
 * @param userId
 */
export const getCurrentStreak = $runtime.makeTypedQueryFactory("WITH daily_results AS (\nSELECT\nDATE(r.created_at) as game_date,\nMAX(r.win) as won_day -- 1 if they won at least once that day\nFROM result r\nJOIN invention_of_the_day iotd ON r.iotd_id = iotd.id\nWHERE r.user_id = :userId\nGROUP BY 1\n),\nstreak_calc AS (\nSELECT\ngame_date,\nwon_day,\nJULIANDAY(game_date) - ROW_NUMBER() OVER (ORDER BY game_date) as grp\nFROM daily_results\nWHERE won_day = 1\n),\nlatest_streak AS (\nSELECT\nCOUNT(*) as streak_length,\nMAX(game_date) as last_win_date\nFROM streak_calc\nGROUP BY grp\nORDER BY last_win_date DESC\nLIMIT 1\n)\nSELECT\nCASE\nWHEN last_win_date >= DATE('now', '-1 day') THEN streak_length\nELSE 0\nEND as current_streak\nFROM latest_streak;") as (userId: unknown) => $runtime.TypedSql<getCurrentStreak.Parameters, getCurrentStreak.Result>

export namespace getCurrentStreak {
  export type Parameters = [userId: unknown]
  export type Result = {
    current_streak: null | null
  }
}
